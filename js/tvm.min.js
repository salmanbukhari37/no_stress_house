function calcPV(e,t,r,n,u){var a=t*Math.pow(1+r/(100*u),-n);return a+=0==r?e*n:e*((1-Math.pow(1+r/(100*u),-n))/(r/(100*u)))}function calcFV(e,t,r,n,u){var a=t*Math.pow(1+r/(100*u),n);return a+=0==r?e*n:e*((Math.pow(1+r/(100*u),n)-1)/(r/(100*u)))}function calcPMT(e,t,r,n,u){var a=0;return 0!=e&&0!=t&&(e*=-1),r>0&&n>0?(a=(e-t*Math.pow(1+r/(100*u),-n))/((1-Math.pow(1+r/(100*u),-n))/(r/(100*u))),0!=t&&(a*=-1)):0==r&&n>0?(a=(e-t)/n,0!=t&&(a*=-1)):(alert("The Number of Payments must be greater than 0."),a=""),a}function calcNR(e,t,r,n,u){var a,i,l=.1,o=1,c=0,v=l;if(n<=0)return alert("The Interest rate can not be computed."),"";if(0==r&&c++,0==e&&c++,0==t&&c++,c>=2)return alert("The Interest rate can not be computed."),"";if(t>0&&e>=0&&r>=0)return alert("The Interest rate can not be computed."),"";if(0==t&&e>=0&&r>=0)return alert("The Interest rate can not be computed."),"";t*=-1;do{if(i=a=calcPV(e,r,100*l,n,u)-t,v=l,l-=a/((calcPV(e,r,100*(l+1e-5),n,u)-t-a)/1e-5),o>200)return alert("The Interest rate can not be computed."),"";o++,i<0&&(i*=-1)}while(i>1e-4);return 100*v}function calcNP(e,t,r,n,u){var a,i,l=5,o=l,c=1,v=0;if(n<=0)return alert("The Number of Payments cannot be computed."),"";if(0==r&&v++,0==e&&v++,0==t&&v++,v>=2)return alert("The Number of Payments cannot be computed."),"";if(t>0&&e>=0&&r>=0)return alert("The Number of Payments cannot be computed."),"";if(0==t&&e>=0&&r>=0)return alert("The Number of Payments cannot be computed."),"";if((t*=-1)==r&&n/(100*u)*r==e)return alert("The Number of Payments is not unique."),"";do{if(i=a=calcPV(e,r,n,l,u)-t,o=l,l-=a/((calcPV(e,r,n,l+.001,u)-t-a)/.001),c>200)return alert("The Number of Payments cannot be computed."),"";c++}while(Math.abs(i)>1e-4);return o}function findPV(e){var t=e.FVInput.value;if(!isNumber(t))return!1;""==t&&(t=0);var r=e.PMTInput.value;if(!isNumber(r))return!1;""==r&&(r=0);var n=e.NPInput.value;if(!isPositiveNumber(n))return!1;""==n&&(n=0);var u,a=e.NRInput.value;if(!isPositiveNumber(a))return!1;""==a&&(a=0);var i=$('select[name="CInput"]').find(":selected").val();3==i?u=12:4==i?u=52:5==i&&(u=365);var l=calcPV(r,t,a,n,u);return e.PVInput.value=""+Math.round(100*-l)/100,!0}function findPMT(e){var t=e.PVInput.value;if(!isNumber(t))return!1;""==t&&(t=0);var r=e.FVInput.value;if(!isNumber(r))return!1;""==r&&(r=0);var n=e.NPInput.value;if(!isPositiveNumber(n))return!1;""==n&&(n=0);var u,a=e.NRInput.value;if(!isPositiveNumber(a))return!1;""==a&&(a=0);var i=$('select[name="CInput"]').find(":selected").val();3==i?u=12:4==i?u=52:5==i&&(u=365);var l=calcPMT(t,r,a,n,u);return e.PMTInput.value=""==l?"":""+Math.round(100*l)/100,!0}function findFV(e){var t=e.PVInput.value;if(!isNumber(t))return!1;""==t&&(t=0);var r=e.PMTInput.value;if(!isNumber(r))return!1;""==r&&(r=0);var n=e.NPInput.value;if(!isPositiveNumber(n))return!1;""==n&&(n=0);var u,a=e.NRInput.value;if(!isPositiveNumber(a))return!1;""==a&&(a=0);var i=$('select[name="CInput"]').find(":selected").val();3==i?u=12:4==i?u=52:5==i&&(u=365);var l=calcFV(r,t,a,n,u);return e.FVInput.value=""+Math.round(100*-l)/100,!0}function findNR(e){var t=e.FVInput.value;if(!isNumber(t))return!1;""==t&&(t=0);var r=e.PMTInput.value;if(!isNumber(r))return!1;""==r&&(r=0);var n=e.NPInput.value;if(!isPositiveNumber(n))return!1;""==n&&(n=0);var u,a=e.PVInput.value;if(!isNumber(a))return!1;""==a&&(a=0);var i=$('select[name="CInput"]').find(":selected").val();3==i?u=12:4==i?u=52:5==i&&(u=365);var l=calcNR(r,a,t,n,u);return e.NRInput.value=""==l?"":""+Math.round(100*l)/100,!0}function findNP(e){var t=e.FVInput.value;if(!isNumber(t))return!1;""==t&&(t=0);var r=-e.PMTInput.value;if(!isNumber(r))return!1;""==r&&(r=0);var n=e.NRInput.value;if(!isPositiveNumber(n))return!1;""==n&&(n=0);var u,a=e.PVInput.value;if(!isNumber(a))return!1;""==a&&(a=0);var i=$('select[name="CInput"]').find(":selected").val();3==i?u=12:4==i?u=52:5==i&&(u=365);var l=calcNP(r,a,t,n,u);return e.NPInput.value=""==l?"":""+Math.round(100*l)/100,!0}function isPositiveNumber(e){var t=!1;if("."==e)return alert("Please make sure that only numbers are input."),!1;for(var r=0;r<e.length;r++){var n=e.substring(r,r+1);if(!(n>="0"&&n<="9"||"."==n&&0==t))return alert("Please make sure that only numbers are input."),!1;"."==n&&(t=!0)}return!0}function isNumber(e){var t=!1;if("."==e)return alert("Please make sure that only numbers are input."),!1;for(var r=0;r<e.length;r++){var n=e.substring(r,r+1);if(0==r&&e.length>1){if(!(n>="0"&&n<="9"||"."==n&&0==t||"-"==n))return alert("Please make sure that only numbers are input."),!1}else if(!(n>="0"&&n<="9"||"."==n&&0==t))return alert("Please make sure that only numbers are input."),!1;"."==n&&(t=!0)}return!0}function launchTVMCalc(){window.open("TVMCalcWindow.html","Win2","menubar,resizable,height=205,width=315")}window.onload=function(){function e(e){return e.stopPropagation?e.stopPropagation():window.event&&(window.event.cancelBubble=!0),e.preventDefault(),!1}document.addEventListener("contextmenu",function(e){e.preventDefault()},!1),document.addEventListener("keydown",function(t){t.ctrlKey&&t.shiftKey&&73==t.keyCode&&e(t),t.ctrlKey&&t.shiftKey&&74==t.keyCode&&e(t),83==t.keyCode&&(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&e(t),t.ctrlKey&&85==t.keyCode&&e(t),123==event.keyCode&&e(t)},!1)};